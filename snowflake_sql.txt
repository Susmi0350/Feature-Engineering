-- Creating workspace
USE ROLE ACCOUNTADMIN;
CREATE WAREHOUSE ML_WH;
CREATE DATABASE CUSTOMER_DATA;
CREATE SCHEMA FEATURE_STORE;

--using built-in sample data
USE SCHEMA SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL;

--creating feature table
CREATE OR REPLACE TABLE CUSTOMER_FEATURES AS
SELECT 
  C_CUSTOMER_SK AS CUSTOMER_ID,
  COUNT(O_ORDER_SK) AS TOTAL_ORDERS,
  AVG(I_CURRENT_PRICE) AS AVG_SPEND
FROM 
  ORDERS 
JOIN ITEM ON ORDERS.I_ITEM_SK = ITEM.I_ITEM_SK
GROUP BY 1;
